import numpy as np 
import Higgs.predictions as HP
import Higgs.bounds as HB
import Higgs.signals as HS
pred = HP.Predictions()
PC = 'FTRSM/Parameter_Cards/Corine_TRSM_SSX_PC.dat'
bounds = HB.Bounds("/home/cmsphysics/higgstools/HBdata")
signals = HS.Signals("/home/cmsphysics/higgstools/HSdata")
#FROM TRSM + SSX PARAMETER CARD 
#h1
h1 = pred.addParticle(HP.NeutralScalar("h1", "even"))
h1.setMass(125.09)  # Mass SM-Higgs
decay_width_h1 = 0.0038110045676034245
h1.setDecayWidth("h1", "h1", decay_width_h1)
#h1.setDecayWidth("h1",0.0038110045676034245)  # Width SM-Higgs 
HP.effectiveCouplingInput(h1, HP.smLikeEffCouplings)
#h2 
h2 = pred.addParticle(HP.NeutralScalar("h2","even"))
h2.setMass(263) #Mass Higgs-Like Boson M2
decay_width_h2 = 0.12028982767301252
h2.setDecayWidth("h2", "h2", decay_width_h2)  # Width Higgs-Like Boson M2 
HP.effectiveCouplingInput(h2, HP.smLikeEffCouplings)
#h3
h3 = pred.addParticle(HP.NeutralScalar("h3","even"))
h3.setMass(455) #Mass Higgs-Like Boson M3
decay_width_h3 = 7.510553931822905
h3.setDecayWidth("h3", "h3", decay_width_h3) # Width Higgs-Like Boson M3
HP.effectiveCouplingInput(h3, HP.smLikeEffCouplings)
chisqSM = signals(pred)
# evaluate HiggsBounds
hbresult = bounds(pred)
print(hbresult)
# evaluate HiggsSignals
chisq = signals(pred)
print(f"HiggsSignals chisq: {chisq} compared to a SM chisq of {chisqSM}")
